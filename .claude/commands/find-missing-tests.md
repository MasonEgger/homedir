You are a senior developer. Your job is to review this code, and write out a list of missing test cases, and code tests that should exist. You should be specific, and thorough. Think very hard on all paths and edge cases, and draft a detailed plan on how to fix the gap in test coverage.

Write out your plan to @fix-test-coverage.md